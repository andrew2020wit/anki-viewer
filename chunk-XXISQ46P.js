import{c as u}from"./chunk-RLXH5NIV.js";import{a as l}from"./chunk-6OMX4HG3.js";import{A as s,D as c,G as f,i as a,j as p,ma as m,pb as h,r as i,y as d}from"./chunk-JKVYAKCR.js";var b=(n=>(n[n.Again=1]="Again",n[n.Hard=2]="Hard",n[n.Normal=3]="Normal",n[n.Easy=4]="Easy",n))(b||{});var I="http://127.0.0.1:8765";var k="ankiRequestText";var y={0:"new",1:"learning",2:"review",3:"relearning",9:"unknown"};var C=class t{transform(r){if(!r)return"";let e=r.lastIndexOf("$");if(e===-1)return r;let o=r.slice(e+1),n=r.slice(0,e);return o.trim()===n.trim()?o:r}static \u0275fac=function(e){return new(e||t)};static \u0275pipe=m({name:"transcription",type:t,pure:!0})};function R(t){return t?t.replace("[sound:","").replace("]","").trim():""}var L=(t,r)=>t.type!==r.type?t.type-r.type:t.due-r.due;var S={ForgetCard:["0"],GoHome:["home","h","\u0440"],LearnAgain:["1"],PlayAudio:["r","\u043A"],RestoreLastCard:["z","\u044F"],SetEasy:["4"],SetHard:["2"],SetNormal:["3","enter"],ShowExtraInfo:[" "]};function _(t,r){return S[t].includes(r)}var g=class t{constructor(r,e){this.http=r;this.info=e}ankiHost=localStorage.getItem(l.key)||I;getCardById(r){return this.http.post(this.ankiHost,{action:"cardsInfo",version:6,params:{cards:[r]}}).pipe(s(e=>{e?.error&&this.info.error("Anki findCards error")}),p(e=>e.result?.[0]))}findCards(r){return this.http.post(this.ankiHost,{action:"findCards",version:6,params:{query:r}}).pipe(i(e=>{throw this.info.error("There is error with anki-connection"),e}),s(e=>{e?.error&&this.info.error("Anki findCards error")}),d(e=>this.http.post(this.ankiHost,{action:"cardsInfo",version:6,params:{cards:e.result}}).pipe(s(o=>{o?.error&&this.info.error("Anki findCards error")}),p(o=>o.result))))}forgetCard(r){return r?this.http.post(this.ankiHost,{action:"forgetCards",version:6,params:{cards:[r]}}).pipe(i(e=>{throw this.info.error("There is error with anki-connection"),e})):a(!1)}answerCardsByIds(r,e){return r.length?this.http.post(this.ankiHost,{action:"answerCards",version:6,params:{answers:r.map(o=>({cardId:o,ease:e}))}}).pipe(i(o=>{throw this.info.error("There is error with anki-connection"),o})):a(!1)}static \u0275fac=function(e){return new(e||t)(f(h),f(u))};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};export{b as a,k as b,y as c,C as d,R as e,L as f,_ as g,g as h};
