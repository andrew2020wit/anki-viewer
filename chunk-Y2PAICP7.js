import{a as q}from"./chunk-BUG2RXMT.js";import{c as z,d as R,e as N}from"./chunk-CV7V65U2.js";import"./chunk-SW2ZE6OU.js";import{Ca as o,Da as r,Ea as x,I as L,Ia as g,Sa as s,Ua as d,Y as k,ab as E,bb as H,da as _,ea as t,ia as O,ma as T,pa as I,ra as M,s as y,u as w,va as C,wa as h,wb as A,ya as v}from"./chunk-U47C5U2E.js";var S=class i{transform(l){if(!l)return"";let e=l.lastIndexOf("$");if(e===-1)return l;let n=l.slice(e+1),a=l.slice(0,e);return n.trim()===a.trim()?n:l}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=I({name:"transcription",type:i,pure:!0})};function K(i,l){if(i&1&&(o(0,"span",12),s(1),r()),i&2){let e,n=g(3);t(),d(" ",(e=n.ankiCard())==null||e.fields==null||e.fields.phVerb==null?null:e.fields.phVerb.value," ")}}function V(i,l){if(i&1&&x(0,"span",13),i&2){let e,n=g(3);C("innerHTML",(e=n.ankiCard())==null||e.fields==null||e.fields.lexunit==null?null:e.fields.lexunit.value,_)}}function j(i,l){if(i&1&&(o(0,"div",10),M(1,K,2,1,"span",12)(2,V,1,1,"span",13),r()),i&2){let e,n,a=g(2);t(),v(!((e=a.ankiCard())==null||e.fields==null||e.fields.phVerb==null)&&e.fields.phVerb.value?1:-1),t(),v(!((n=a.ankiCard())==null||n.fields==null||n.fields.lexunit==null)&&n.fields.lexunit.value?2:-1)}}function F(i,l){if(i&1&&x(0,"div",18),i&2){let e,n=g(3);C("innerHTML",(e=n.ankiCard())==null||e.fields==null||e.fields.translation==null?null:e.fields.translation.value,_)}}function U(i,l){if(i&1&&(o(0,"div",14),x(1,"span",15),E(2,"transcription"),o(3,"span",16)(4,"span"),s(5),r(),o(6,"span"),s(7),r()()(),x(8,"div",17),M(9,F,1,1,"div",18),o(10,"div",19)(11,"span"),s(12),r(),o(13,"span"),s(14),r(),o(15,"span",20),s(16),r(),o(17,"span"),s(18),r()()),i&2){let e,n,a,m,c,f,p,b,P,u=g(2);t(),C("innerHTML",H(2,17,(e=u.ankiCard())==null||e.fields==null||e.fields.transcription==null?null:e.fields.transcription.value),_),t(4),d(" ",(n=u.ankiCard())==null||n.fields==null||n.fields.freq==null?null:n.fields.freq.value," "),t(2),d(" ",(a=u.ankiCard())==null||a.fields==null||a.fields.freq2==null?null:a.fields.freq2.value," "),t(),C("innerHTML",(m=u.ankiCard())==null||m.fields==null||m.fields.def==null?null:m.fields.def.value,_),t(),v(!((c=u.ankiCard())==null||c.fields==null||c.fields.translation==null)&&c.fields.translation.value?9:-1),t(2),h("was-last",u.lastAnswer()===1),t(),d("",(f=u.ankiCard())==null||f.nextReviews==null?null:f.nextReviews[0]," "),t(),h("was-last",u.lastAnswer()===2),t(),d("",(p=u.ankiCard())==null||p.nextReviews==null?null:p.nextReviews[1]," "),t(),h("was-last",u.lastAnswer()===3),t(),d("",(b=u.ankiCard())==null||b.nextReviews==null?null:b.nextReviews[2]," "),t(),h("was-last",u.lastAnswer()===4),t(),d("",(P=u.ankiCard())==null||P.nextReviews==null?null:P.nextReviews[3]," ")}}function X(i,l){if(i&1&&(o(0,"div",0)(1,"div",6)(2,"span",4),s(3),r(),x(4,"span",7),o(5,"span",8),s(6),r(),x(7,"span",9),M(8,j,3,2,"div",10),r(),x(9,"div",11),M(10,U,19,19),r()),i&2){let e,n,a,m,c,f,p=g();t(3),d(" ",p.ankiCardTypes[((e=p.ankiCard())==null?null:e.type)||0]," :"),t(),C("innerHTML",(n=p.ankiCard())==null||n.fields==null||n.fields.term==null?null:n.fields.term.value,_),t(2),d(" (",(a=p.ankiCard())==null||a.fields==null||a.fields.pos==null?null:a.fields.pos.value,") "),t(),C("innerHTML",(m=p.ankiCard())==null||m.fields==null||m.fields.registerlab==null?null:m.fields.registerlab.value,_),t(),v(!((c=p.ankiCard())==null||c.fields==null||c.fields.phVerb==null)&&c.fields.phVerb.value||!((c=p.ankiCard())==null||c.fields==null||c.fields.lexunit==null)&&c.fields.lexunit.value?8:-1),t(),C("innerHTML",(f=p.ankiCard())==null||f.fields==null||f.fields.exampleText==null?null:f.fields.exampleText.value,_),t(),v(p.showBackSide()?10:-1)}}var B=class i{constructor(l,e){this.ankiConnectService=l;this.info=e}isLoading=k(!1);ankiCard=k(null);cardsNumber=k(0);showBackSide=k(!0);lastAnswer=k(0);ankiCardTypes=z;hotKeysService=L(q);hotKeysServiceSubscription;ngOnInit(){this.getCard(),this.takeHotKey()}ngOnDestroy(){this.hotKeysServiceSubscription?.unsubscribe()}getCard(){let l="deck:cald is:due";this.isLoading.set(!0),this.showBackSide.set(!1),this.ankiConnectService.findCards(l).pipe(y(1),w(()=>{this.isLoading.set(!1)})).subscribe(e=>{e.sort((n,a)=>n.due-a.due),this.ankiCard.set(e[0]||null),this.cardsNumber.set(e.length),window.scrollTo(0,0)})}takeHotKey(){this.hotKeysServiceSubscription=this.hotKeysService.hotKeyEvent.subscribe(l=>{switch(l){case" ":this.showBackSide.set(!0);break;case"1":this.answerCard(1);break;case"2":this.answerCard(2);break;case"3":this.answerCard(3);break;case"4":this.answerCard(4);break}})}answerCard(l){this.isLoading.set(!0);let e=this.ankiCard()?.cardId;e&&this.ankiConnectService.answerCardsByIds([e],l).pipe(y(1),w(()=>{this.isLoading.set(!1)})).subscribe(()=>{this.lastAnswer.set(l),this.getCard()})}static \u0275fac=function(e){return new(e||i)(O(N),O(R))};static \u0275cmp=T({type:i,selectors:[["app-learn"]],decls:14,vars:5,consts:[[1,"card"],[1,"settings"],["routerLink","/"],[1,"anki-result-sum"],[1,"card-type"],[1,"hints"],[1,"term-block"],[1,"term",3,"innerHTML"],[1,"pos"],[1,"register-lab",3,"innerHTML"],[1,"lex-unit"],[1,"example",3,"innerHTML"],[1,"ph-verb"],[1,"lex-unit",3,"innerHTML"],[1,"term-extra"],[1,"transcription",3,"innerHTML"],[1,"freq"],[1,"definition",3,"innerHTML"],[1,"translation",3,"innerHTML"],[1,"next-reviews"],[1,"normal"]],template:function(e,n){if(e&1&&(M(0,X,11,7,"div",0),o(1,"div",1)(2,"a",2),s(3," Home "),r(),o(4,"div",3),s(5),r(),o(6,"span",4),s(7),r(),o(8,"span"),s(9),r(),o(10,"span",5),s(11," | Space - show extra, 1-again, 2-hard, 3-normal, 4-ease. "),r(),o(12,"span"),s(13),r()()),e&2){let a,m;v(n.ankiCard()?0:-1),t(5),d("Results: ",n.cardsNumber(),""),t(2),d(" CT: ",n.ankiCardTypes[((a=n.ankiCard())==null?null:a.type)||0]," "),t(2),d(" D: ",(m=n.ankiCard())==null?null:m.deckName," "),t(4),d(" LA: ",n.lastAnswer()," ")}},dependencies:[A,S],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;margin:0 auto;max-width:800px;padding:24px;height:100%;box-sizing:border-box}.settings[_ngcontent-%COMP%]{align-items:center;display:flex;gap:8px;justify-content:start;margin-bottom:24px}.card[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column;align-items:center;justify-content:flex-start;gap:16px}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]{display:flex;font-size:24px;gap:16px;align-items:baseline}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .card-type[_ngcontent-%COMP%]{font-size:14px}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]{color:#00f}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .pos[_ngcontent-%COMP%]{color:green}.card[_ngcontent-%COMP%]   .transcription[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .freq[_ngcontent-%COMP%]{font-size:24px;color:#00f}.card[_ngcontent-%COMP%]   .freq[_ngcontent-%COMP%]{color:#8b0000}.card[_ngcontent-%COMP%]   .example[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .definition[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .translation[_ngcontent-%COMP%]{font-size:24px}.card[_ngcontent-%COMP%]   .translation[_ngcontent-%COMP%]{color:green}.next-reviews[_ngcontent-%COMP%]{display:flex;gap:16px;font-size:24px;padding:4px 8px;border:1px solid gray}.next-reviews[_ngcontent-%COMP%]   .normal[_ngcontent-%COMP%]{color:green}.next-reviews[_ngcontent-%COMP%]   .was-last[_ngcontent-%COMP%]{text-decoration:underline}.ph-verb[_ngcontent-%COMP%]{color:#00008b}.lex-unit[_ngcontent-%COMP%]{color:#8b0000}"]})};export{B as LearnComponent};
