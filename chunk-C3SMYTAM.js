import{a as N}from"./chunk-BUG2RXMT.js";import{c as z,d as R,f as D}from"./chunk-PQGKI6RP.js";import"./chunk-6TPRDAXS.js";import{a as q,b as V}from"./chunk-R5FB43CF.js";import"./chunk-5H7V54M7.js";import"./chunk-WIZ6UHY7.js";import{a as H}from"./chunk-5K5SMW74.js";import{Ca as o,Da as l,Ea as C,I as O,Ia as k,Sa as c,Ua as p,Y as b,ab as T,bb as I,da as v,ea as n,ia as L,ma as E,ra as M,s as w,u as P,va as _,wa as h,wb as A,ya as g}from"./chunk-U47C5U2E.js";function U(i,a){if(i&1&&(o(0,"div",0)(1,"a",5),c(2," Viewer "),l(),C(3,"br")(4,"br"),l()),i&2){let e=k();n(),_("routerLink","/"+e.UrlsEnum.Viewer)}}function j(i,a){if(i&1&&(o(0,"span",14),c(1),l()),i&2){let e,t=k(3);n(),p(" ",(e=t.ankiCard())==null||e.fields==null||e.fields.phVerb==null?null:e.fields.phVerb.value," ")}}function K(i,a){if(i&1&&C(0,"span",15),i&2){let e,t=k(3);_("innerHTML",(e=t.ankiCard())==null||e.fields==null||e.fields.lexunit==null?null:e.fields.lexunit.value,v)}}function F(i,a){if(i&1&&(o(0,"div",12),M(1,j,2,1,"span",14)(2,K,1,1,"span",15),l()),i&2){let e,t,r=k(2);n(),g(!((e=r.ankiCard())==null||e.fields==null||e.fields.phVerb==null)&&e.fields.phVerb.value?1:-1),n(),g(!((t=r.ankiCard())==null||t.fields==null||t.fields.lexunit==null)&&t.fields.lexunit.value?2:-1)}}function $(i,a){if(i&1&&C(0,"div",20),i&2){let e,t=k(3);_("innerHTML",(e=t.ankiCard())==null||e.fields==null||e.fields.translation==null?null:e.fields.translation.value,v)}}function G(i,a){if(i&1&&(o(0,"div",16),C(1,"span",17),T(2,"transcription"),o(3,"span",18)(4,"span"),c(5),l(),o(6,"span"),c(7),l()()(),C(8,"div",19),M(9,$,1,1,"div",20),o(10,"div",21)(11,"span"),c(12),l(),o(13,"span"),c(14),l(),o(15,"span",22),c(16),l(),o(17,"span"),c(18),l()()),i&2){let e,t,r,u,f,m,x,s,y,S,d=k(2);n(),_("innerHTML",I(2,19,(e=d.ankiCard())==null||e.fields==null||e.fields.transcription==null?null:e.fields.transcription.value),v),n(4),p(" ",(t=d.ankiCard())==null||t.fields==null||t.fields.freq==null?null:t.fields.freq.value," "),n(2),p(" ",(r=d.ankiCard())==null||r.fields==null||r.fields.freq2==null?null:r.fields.freq2.value," "),n(),_("innerHTML",(u=d.ankiCard())==null||u.fields==null||u.fields.def==null?null:u.fields.def.value,v),n(),g(!((f=d.ankiCard())==null||f.fields==null||f.fields.translation==null)&&f.fields.translation.value?9:-1),n(),h("review",d.ankiCardTypes[((m=d.ankiCard())==null?null:m.type)||9]==="review"),n(),h("was-last",d.lastAnswer()===1),n(),p("",(x=d.ankiCard())==null||x.nextReviews==null?null:x.nextReviews[0]," "),n(),h("was-last",d.lastAnswer()===2),n(),p("",(s=d.ankiCard())==null||s.nextReviews==null?null:s.nextReviews[1]," "),n(),h("was-last",d.lastAnswer()===3),n(),p("",(y=d.ankiCard())==null||y.nextReviews==null?null:y.nextReviews[2]," "),n(),h("was-last",d.lastAnswer()===4),n(),p("",(S=d.ankiCard())==null||S.nextReviews==null?null:S.nextReviews[3]," ")}}function J(i,a){if(i&1&&(o(0,"div",1)(1,"div",6)(2,"span",7),c(3),l(),o(4,"span",8),c(5),l(),C(6,"span",9),o(7,"span",10),c(8),l(),C(9,"span",11),M(10,F,3,2,"div",12),l(),C(11,"div",13),M(12,G,19,21),l()),i&2){let e,t,r,u,f,m,x,s=k();n(3),p(" ",s.cardsNumber()," "),n(),h("review",s.ankiCardTypes[((e=s.ankiCard())==null?null:e.type)||9]==="review"),n(),p(" ",s.ankiCardTypes[((t=s.ankiCard())==null?null:t.type)||9]," : "),n(),_("innerHTML",(r=s.ankiCard())==null||r.fields==null||r.fields.term==null?null:r.fields.term.value,v),n(2),p(" (",(u=s.ankiCard())==null||u.fields==null||u.fields.pos==null?null:u.fields.pos.value,") "),n(),_("innerHTML",(f=s.ankiCard())==null||f.fields==null||f.fields.registerlab==null?null:f.fields.registerlab.value,v),n(),g(!((m=s.ankiCard())==null||m.fields==null||m.fields.phVerb==null)&&m.fields.phVerb.value||!((m=s.ankiCard())==null||m.fields==null||m.fields.lexunit==null)&&m.fields.lexunit.value?10:-1),n(),_("innerHTML",(x=s.ankiCard())==null||x.fields==null||x.fields.exampleText==null?null:x.fields.exampleText.value,v),n(),g(s.showBackSide()?12:-1)}}var B=class i{constructor(a){this.ankiConnectService=a}isLoading=b(!1);ankiCard=b(null);cardsNumber=b(0);showBackSide=b(!0);lastAnswer=b(0);UrlsEnum=H;ankiCardTypes=z;hotKeysService=O(N);hotKeysServiceSubscription;htmLAudioElement=null;ngOnInit(){this.getCard(),this.takeHotKey()}ngOnDestroy(){this.hotKeysServiceSubscription?.unsubscribe()}getCard(){let e=`deck:${localStorage.getItem(V.key)||"cald"} is:due`;this.isLoading.set(!0),this.showBackSide.set(!1),this.ankiConnectService.findCards(e).pipe(w(1),P(()=>{this.isLoading.set(!1)})).subscribe(t=>{t.sort((r,u)=>r.due-u.due),this.ankiCard.set(t[0]||null),this.cardsNumber.set(t.length),window.scrollTo(0,0),this.initAudio()})}takeHotKey(){this.hotKeysServiceSubscription=this.hotKeysService.hotKeyEvent.subscribe(a=>{switch(a){case" ":this.showBackSide.set(!0);break;case"1":this.answerCard(1);break;case"2":this.answerCard(2);break;case"3":this.answerCard(3);break;case"4":this.answerCard(4);break;case"r":this.replayAudio();break}})}answerCard(a){this.isLoading.set(!0);let e=this.ankiCard()?.cardId;e&&this.ankiConnectService.answerCardsByIds([e],a).pipe(w(1),P(()=>{this.isLoading.set(!1)})).subscribe(()=>{this.lastAnswer.set(a),this.getCard()})}initAudio(){let a=this.ankiCard()?.fields?.sound?.value;if(this.htmLAudioElement=null,!a)return;let e=a.replaceAll("[sound:","").replaceAll("]","").trim(),t=localStorage.getItem(q.key);!e||!t||(this.htmLAudioElement=new Audio(t+e),this.htmLAudioElement.play())}replayAudio(){this.htmLAudioElement?.play()}static \u0275fac=function(e){return new(e||i)(L(D))};static \u0275cmp=E({type:i,selectors:[["app-learn"]],decls:9,vars:3,consts:[[1,"empty-block"],[1,"card"],[1,"settings"],["routerLink","/"],[1,"hints"],[3,"routerLink"],[1,"term-block"],[1,"cards-number"],[1,"card-type"],[1,"term",3,"innerHTML"],[1,"pos"],[1,"register-lab",3,"innerHTML"],[1,"lex-unit"],[1,"example",3,"innerHTML"],[1,"ph-verb"],[1,"lex-unit",3,"innerHTML"],[1,"term-extra"],[1,"transcription",3,"innerHTML"],[1,"freq"],[1,"definition",3,"innerHTML"],[1,"translation",3,"innerHTML"],[1,"next-reviews"],[1,"normal"]],template:function(e,t){if(e&1&&(M(0,U,5,1,"div",0)(1,J,13,10,"div",1),o(2,"div",2)(3,"a",3),c(4," Home "),l(),o(5,"span"),c(6),l(),o(7,"span",4),c(8," | Space - show extra, 1-again, 2-hard, 3-normal, 4-ease. R - replay sound. "),l()()),e&2){let r;g(t.ankiCard()?-1:0),n(),g(t.ankiCard()?1:-1),n(5),p(" Deck: ",(r=t.ankiCard())==null?null:r.deckName," ")}},dependencies:[A,R],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;margin:0 auto;max-width:800px;padding:24px;height:100%;box-sizing:border-box}.settings[_ngcontent-%COMP%]{align-items:center;display:flex;gap:8px;justify-content:start;margin-bottom:24px}.card[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column;align-items:center;justify-content:flex-start;gap:16px}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]{display:flex;font-size:24px;gap:16px;align-items:baseline}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .card-type[_ngcontent-%COMP%]{font-size:14px}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .card-type.review[_ngcontent-%COMP%]{color:green}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]{color:#00f}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .pos[_ngcontent-%COMP%]{color:green}.card[_ngcontent-%COMP%]   .transcription[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .freq[_ngcontent-%COMP%]{font-size:24px;color:#00f}.card[_ngcontent-%COMP%]   .freq[_ngcontent-%COMP%]{color:#8b0000}.card[_ngcontent-%COMP%]   .example[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .definition[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .translation[_ngcontent-%COMP%]{font-size:24px}.card[_ngcontent-%COMP%]   .translation[_ngcontent-%COMP%]{color:green}.next-reviews[_ngcontent-%COMP%]{display:flex;gap:16px;font-size:24px;padding:4px 8px;border:1px solid gray}.next-reviews.review[_ngcontent-%COMP%]{border:1px solid darkred;outline:1px solid darkred}.next-reviews[_ngcontent-%COMP%]   .normal[_ngcontent-%COMP%]{color:green}.next-reviews[_ngcontent-%COMP%]   .was-last[_ngcontent-%COMP%]{text-decoration:underline}.ph-verb[_ngcontent-%COMP%]{color:#00008b}.lex-unit[_ngcontent-%COMP%]{color:#8b0000}.cards-number[_ngcontent-%COMP%]{color:#8b008b}"]})};export{B as LearnComponent};
