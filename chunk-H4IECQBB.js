import{c as I}from"./chunk-POCYZ5R7.js";import{o as u}from"./chunk-GWILJIGV.js";import{D as d,F as s,I as c,L as f,j as a,k as p,t as i,ua as m,yb as l}from"./chunk-Q4LM43N5.js";var b=(n=>(n[n.Again=1]="Again",n[n.Hard=2]="Hard",n[n.Normal=3]="Normal",n[n.Easy=4]="Easy",n))(b||{});var h="http://127.0.0.1:8765";var x="ankiRequestText";var H={0:"new",1:"learning",2:"review",3:"relearning",9:"unknown"};var C=class t{transform(r){if(!r)return"";let e=r.lastIndexOf("$");if(e===-1)return r;let o=r.slice(e+1),n=r.slice(0,e);return o.trim()===n.trim()?o:r}static \u0275fac=function(e){return new(e||t)};static \u0275pipe=m({name:"transcription",type:t,pure:!0})};function T(t){return t?t.replace("[sound:","").replace("]","").trim():""}var L=(t,r)=>t.type!==r.type?t.type-r.type:t.due-r.due;var A={ShowExtraInfo:[" "],LearnAgain:["1"],SetHard:["2"],SetNormal:["3","enter"],SetEasy:["4"],ForgetCard:["0"],ReplayAudio:["r","\u043A"],RestoreLastCard:["z","\u044F"]};function _(t,r){return A[t].includes(r)}var g=class t{constructor(r,e){this.http=r;this.info=e}ankiHost=localStorage.getItem(u.key)||h;getCardById(r){return this.http.post(this.ankiHost,{action:"cardsInfo",version:6,params:{cards:[r]}}).pipe(s(e=>{e?.error&&this.info.error("Anki findCards error")}),p(e=>e.result?.[0]))}findCards(r){return this.http.post(this.ankiHost,{action:"findCards",version:6,params:{query:r}}).pipe(i(e=>{throw this.info.error("There is error with anki-connection"),e}),s(e=>{e?.error&&this.info.error("Anki findCards error")}),d(e=>this.http.post(this.ankiHost,{action:"cardsInfo",version:6,params:{cards:e.result}}).pipe(s(o=>{o?.error&&this.info.error("Anki findCards error")}),p(o=>o.result))))}forgetCard(r){return r?this.http.post(this.ankiHost,{action:"forgetCards",version:6,params:{cards:[r]}}).pipe(i(e=>{throw this.info.error("There is error with anki-connection"),e})):a(!1)}answerCardsByIds(r,e){return r.length?this.http.post(this.ankiHost,{action:"answerCards",version:6,params:{answers:r.map(o=>({cardId:o,ease:e}))}}).pipe(i(o=>{throw this.info.error("There is error with anki-connection"),o})):a(!1)}static \u0275fac=function(e){return new(e||t)(f(l),f(I))};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};export{b as a,x as b,H as c,C as d,T as e,L as f,_ as g,g as h};
