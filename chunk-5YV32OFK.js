import{a as Ot,c as Pt,d as Mt,e as It,f as Et,g as y,h as Ht}from"./chunk-65D7CBQH.js";import{a as Lt,b as St,c as Dt,d as Rt,e as N,f as Nt}from"./chunk-P3T3RLCI.js";import{a as gt}from"./chunk-5K5SMW74.js";import{c as kt,d as At}from"./chunk-6OMX4HG3.js";import{$ as B,$a as ct,Aa as c,Ab as vt,Ba as l,Bb as Ct,Ca as g,Cb as U,Da as R,E as Q,Eb as yt,F as Y,Fa as w,Ga as _,H as m,Ka as ot,Kb as bt,L as O,La as st,M as P,Ma as rt,Mb as Tt,Nb as xt,Q as W,Qa as p,Ra as at,Rb as G,Sa as f,T as J,Ua as lt,Vb as wt,W as A,Xb as j,Y as v,Z as tt,_a as dt,a as k,aa as T,ba as a,db as pt,f as F,fa as S,ga as et,ja as D,ka as it,kb as mt,la as nt,nb as ht,oa as L,s as I,t as E,ta as u,tb as ut,ua as C,vb as _t,wa as x,wb as ft,z as b}from"./chunk-BQGAW33D.js";var X="cald";var Kt=["tooltip"],q=20;var K=new Y("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let n=m(N);return()=>n.scrollStrategies.reposition({scrollThrottle:q})}});function Ft(n){return()=>n.scrollStrategies.reposition({scrollThrottle:q})}var Yt={provide:K,deps:[N],useFactory:Ft};function Bt(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}var Ut=new Y("mat-tooltip-default-options",{providedIn:"root",factory:Bt});var Vt="tooltip-panel",zt=Ct({passive:!0}),$t=8,Zt=8,Qt=24,Wt=200,$=(()=>{class n{_elementRef=m(A);_ngZone=m(J);_platform=m(vt);_ariaDescriber=m(xt);_focusMonitor=m(yt);_dir=m(wt);_injector=m(W);_viewContainerRef=m(et);_defaultOptions=m(Ut,{optional:!0});_overlayRef;_tooltipInstance;_portal;_position="below";_positionAtOrigin=!1;_disabled=!1;_tooltipClass;_viewInitialized=!1;_pointerExitEventsInitialized=!1;_tooltipComponent=Gt;_viewportMargin=8;_currentPosition;_cssClassPrefix="mat-mdc";_ariaDescriptionPending;_dirSubscribed=!1;get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(t){this._positionAtOrigin=G(t),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(t){let e=G(t);this._disabled!==e&&(this._disabled=e,e?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=U(t)}_showDelay;get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=U(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}_hideDelay;touchGestures="auto";get message(){return this._message}set message(t){let e=this._message;this._message=t!=null?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(e)}_message="";get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}_passiveListeners=[];_touchstartTimeout=null;_destroyed=new F;_isDestroyed=!1;constructor(){let t=this._defaultOptions;t&&(this._showDelay=t.showDelay,this._hideDelay=t.hideDelay,t.position&&(this.position=t.position),t.positionAtOrigin&&(this.positionAtOrigin=t.positionAtOrigin),t.touchGestures&&(this.touchGestures=t.touchGestures),t.tooltipClass&&(this.tooltipClass=t.tooltipClass)),this._viewportMargin=$t}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(b(this._destroyed)).subscribe(t=>{t?t==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){let t=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([e,i])=>{t.removeEventListener(e,i,zt)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._isDestroyed=!0,this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay,e){if(this.disabled||!this.message||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let i=this._createOverlay(e);this._detach(),this._portal=this._portal||new St(this._tooltipComponent,this._viewContainerRef);let o=this._tooltipInstance=i.attach(this._portal).instance;o._triggerElement=this._elementRef.nativeElement,o._mouseLeaveHideDelay=this._hideDelay,o.afterHidden().pipe(b(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),o.show(t)}hide(t=this.hideDelay){let e=this._tooltipInstance;e&&(e.isVisible()?e.hide(t):(e._cancelPendingAnimations(),this._detach()))}toggle(t){this._isTooltipVisible()?this.hide():this.show(void 0,t)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(t){if(this._overlayRef){let r=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!t)&&r._origin instanceof A)return this._overlayRef;this._detach()}let e=this._injector.get(Dt).getAncestorScrollContainers(this._elementRef),i=this._injector.get(N),o=i.position().flexibleConnectedTo(this.positionAtOrigin?t||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(e);return o.positionChanges.pipe(b(this._destroyed)).subscribe(r=>{this._updateCurrentPositionClass(r.connectionPair),this._tooltipInstance&&r.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=i.create({direction:this._dir,positionStrategy:o,panelClass:`${this._cssClassPrefix}-${Vt}`,scrollStrategy:this._injector.get(K)()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(b(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(b(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(b(this._destroyed)).subscribe(r=>{this._isTooltipVisible()&&r.keyCode===27&&!Tt(r)&&(r.preventDefault(),r.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._dirSubscribed||(this._dirSubscribed=!0,this._dir.change.pipe(b(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){let e=t.getConfig().positionStrategy,i=this._getOrigin(),o=this._getOverlayPosition();e.withPositions([this._addOffset(k(k({},i.main),o.main)),this._addOffset(k(k({},i.fallback),o.fallback))])}_addOffset(t){let e=Zt,i=!this._dir||this._dir.value=="ltr";return t.originY==="top"?t.offsetY=-8:t.originY==="bottom"?t.offsetY=e:t.originX==="start"?t.offsetX=i?-8:e:t.originX==="end"&&(t.offsetX=i?e:-8),t}_getOrigin(){let t=!this._dir||this._dir.value=="ltr",e=this.position,i;e=="above"||e=="below"?i={originX:"center",originY:e=="above"?"top":"bottom"}:e=="before"||e=="left"&&t||e=="right"&&!t?i={originX:"start",originY:"center"}:(e=="after"||e=="right"&&t||e=="left"&&!t)&&(i={originX:"end",originY:"center"});let{x:o,y:r}=this._invertPosition(i.originX,i.originY);return{main:i,fallback:{originX:o,originY:r}}}_getOverlayPosition(){let t=!this._dir||this._dir.value=="ltr",e=this.position,i;e=="above"?i={overlayX:"center",overlayY:"bottom"}:e=="below"?i={overlayX:"center",overlayY:"top"}:e=="before"||e=="left"&&t||e=="right"&&!t?i={overlayX:"end",overlayY:"center"}:(e=="after"||e=="right"&&t||e=="left"&&!t)&&(i={overlayX:"start",overlayY:"center"});let{x:o,y:r}=this._invertPosition(i.overlayX,i.overlayY);return{main:i,fallback:{overlayX:o,overlayY:r}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),B(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,e){return this.position==="above"||this.position==="below"?e==="top"?e="bottom":e==="bottom"&&(e="top"):t==="end"?t="start":t==="start"&&(t="end"),{x:t,y:e}}_updateCurrentPositionClass(t){let{overlayY:e,originX:i,originY:o}=t,r;if(e==="center"?this._dir&&this._dir.value==="rtl"?r=i==="end"?"left":"right":r=i==="start"?"left":"right":r=e==="bottom"&&o==="top"?"above":"below",r!==this._currentPosition){let d=this._overlayRef;if(d){let M=`${this._cssClassPrefix}-${Vt}-`;d.removePanelClass(M+this._currentPosition),d.addPanelClass(M+r)}this._currentPosition=r}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",t=>{this._setupPointerExitEventsIfNeeded();let e;t.x!==void 0&&t.y!==void 0&&(e=t),this.show(void 0,e)}]):this.touchGestures!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",t=>{let e=t.targetTouches?.[0],i=e?{x:e.clientX,y:e.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout);let o=500;this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,i)},this._defaultOptions?.touchLongPressShowDelay??o)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",e=>{let i=e.relatedTarget;(!i||!this._overlayRef?.overlayElement.contains(i))&&this.hide()}],["wheel",e=>this._wheelListener(e)]);else if(this.touchGestures!=="off"){this._disableNativeGesturesIfNecessary();let e=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions?.touchendHideDelay)};t.push(["touchend",e],["touchcancel",e])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([e,i])=>{this._elementRef.nativeElement.addEventListener(e,i,zt)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){let e=this._injector.get(mt).elementFromPoint(t.clientX,t.clientY),i=this._elementRef.nativeElement;e!==i&&!i.contains(e)&&this.hide()}}_disableNativeGesturesIfNecessary(){let t=this.touchGestures;if(t!=="off"){let e=this._elementRef.nativeElement,i=e.style;(t==="on"||e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA")&&(i.userSelect=i.msUserSelect=i.webkitUserSelect=i.MozUserSelect="none"),(t==="on"||!e.draggable)&&(i.webkitUserDrag="none"),i.touchAction="none",i.webkitTapHighlightColor="transparent"}}_syncAriaDescription(t){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,t,"tooltip"),this._isDestroyed||B({write:()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")}},{injector:this._injector}))}static \u0275fac=function(e){return new(e||n)};static \u0275dir=nt({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(e,i){e&2&&C("mat-mdc-tooltip-disabled",i.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]})}return n})(),Gt=(()=>{class n{_changeDetectorRef=m(pt);_elementRef=m(A);_isMultiline=!1;message;tooltipClass;_showTimeoutId;_hideTimeoutId;_triggerElement;_mouseLeaveHideDelay;_animationsDisabled;_tooltip;_closeOnInteraction=!1;_isVisible=!1;_onHide=new F;_showAnimation="mat-mdc-tooltip-show";_hideAnimation="mat-mdc-tooltip-hide";constructor(){let t=m(tt,{optional:!0});this._animationsDisabled=t==="NoopAnimations"}show(t){this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){let t=this._elementRef.nativeElement.getBoundingClientRect();return t.height>Qt&&t.width>=Wt}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_cancelPendingAnimations(){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){let e=this._tooltip.nativeElement,i=this._showAnimation,o=this._hideAnimation;if(e.classList.remove(t?o:i),e.classList.add(t?i:o),this._isVisible!==t&&(this._isVisible=t,this._changeDetectorRef.markForCheck()),t&&!this._animationsDisabled&&typeof getComputedStyle=="function"){let r=getComputedStyle(e);(r.getPropertyValue("animation-duration")==="0s"||r.getPropertyValue("animation-name")==="none")&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(e.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=D({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(e,i){if(e&1&&ot(Kt,7),e&2){let o;st(o=rt())&&(i._tooltip=o.first)}},hostAttrs:["aria-hidden","true"],hostBindings:function(e,i){e&1&&w("mouseleave",function(r){return i._handleMouseLeave(r)})},decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(e,i){if(e&1){let o=R();c(0,"div",1,0),w("animationend",function(d){return O(o),P(i._handleAnimationEnd(d))}),c(2,"div",2),p(3),l()()}e&2&&(C("mdc-tooltip--multiline",i._isMultiline),u("ngClass",i.tooltipClass),a(3),at(i.message))},dependencies:[ht],styles:[`.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mdc-plain-tooltip-container-color, var(--mat-sys-inverse-surface));color:var(--mdc-plain-tooltip-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-plain-tooltip-container-shape, var(--mat-sys-corner-extra-small));font-family:var(--mdc-plain-tooltip-supporting-text-font, var(--mat-sys-body-small-font));font-size:var(--mdc-plain-tooltip-supporting-text-size, var(--mat-sys-body-small-size));font-weight:var(--mdc-plain-tooltip-supporting-text-weight, var(--mat-sys-body-small-weight));line-height:var(--mdc-plain-tooltip-supporting-text-line-height, var(--mat-sys-body-small-line-height));letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, var(--mat-sys-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel{line-height:normal}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}
`],encapsulation:2,changeDetection:0})}return n})(),Z=(()=>{class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=it({type:n});static \u0275inj=Q({providers:[Yt],imports:[bt,Nt,j,j,Rt]})}return n})();function te(n,s){if(n&1&&(c(0,"div",0)(1,"a",5),p(2," Viewer "),l(),g(3,"br")(4,"br"),l()),n&2){let t=_();a(),u("routerLink","/"+t.UrlsEnum.Viewer)}}function ee(n,s){if(n&1&&(c(0,"span",17),p(1),l()),n&2){let t,e=_(3);a(),f(" ",(t=e.ankiCard())==null||t.fields==null||t.fields.phVerb==null?null:t.fields.phVerb.value," ")}}function ie(n,s){if(n&1&&g(0,"span",18),n&2){let t,e=_(3);u("innerHTML",(t=e.ankiCard())==null||t.fields==null||t.fields.lexunit==null?null:t.fields.lexunit.value,T)}}function ne(n,s){if(n&1&&(c(0,"div",15),L(1,ee,2,1,"span",17)(2,ie,1,1,"span",18),l()),n&2){let t,e,i=_(2);a(),x(!((t=i.ankiCard())==null||t.fields==null||t.fields.phVerb==null)&&t.fields.phVerb.value?1:-1),a(),x(!((e=i.ankiCard())==null||e.fields==null||e.fields.lexunit==null)&&e.fields.lexunit.value?2:-1)}}function oe(n,s){if(n&1&&g(0,"div",23),n&2){let t,e=_(3);u("innerHTML",(t=e.ankiCard())==null||t.fields==null||t.fields.translation==null?null:t.fields.translation.value,T)}}function se(n,s){if(n&1){let t=R();c(0,"div",19),g(1,"span",20),dt(2,"transcription"),c(3,"span",21)(4,"span"),p(5),l(),c(6,"span"),p(7),l()()(),g(8,"div",22),L(9,oe,1,1,"div",23),c(10,"div",24)(11,"span",25),w("click",function(){O(t);let i=_(2);return P(i.answerCard(i.EasyFactorEnum.Again))}),p(12),l(),c(13,"span",26),w("click",function(){O(t);let i=_(2);return P(i.answerCard(i.EasyFactorEnum.Hard))}),p(14),l(),c(15,"span",27),w("click",function(){O(t);let i=_(2);return P(i.answerCard(i.EasyFactorEnum.Normal))}),p(16),l(),c(17,"span",28),w("click",function(){O(t);let i=_(2);return P(i.answerCard(i.EasyFactorEnum.Easy))}),p(18),l()()}if(n&2){let t,e,i,o,r,d,M,H,V,z,h=_(2);a(),u("innerHTML",ct(2,19,(t=h.ankiCard())==null||t.fields==null||t.fields.transcription==null?null:t.fields.transcription.value),T),a(4),f(" ",(e=h.ankiCard())==null||e.fields==null||e.fields.freq==null?null:e.fields.freq.value," "),a(2),f(" ",(i=h.ankiCard())==null||i.fields==null||i.fields.freq2==null?null:i.fields.freq2.value," "),a(),u("innerHTML",(o=h.ankiCard())==null||o.fields==null||o.fields.def==null?null:o.fields.def.value,T),a(),x(!((r=h.ankiCard())==null||r.fields==null||r.fields.translation==null)&&r.fields.translation.value?9:-1),a(),C("review",h.ankiCardTypes[((d=h.ankiCard())==null?null:d.type)||9]==="review"),a(),C("was-last",h.lastAnswer()===1),a(),f(" ",(M=h.ankiCard())==null||M.nextReviews==null?null:M.nextReviews[0]," "),a(),C("was-last",h.lastAnswer()===2),a(),f(" ",(H=h.ankiCard())==null||H.nextReviews==null?null:H.nextReviews[1]," "),a(),C("was-last",h.lastAnswer()===3),a(),f(" ",(V=h.ankiCard())==null||V.nextReviews==null?null:V.nextReviews[2]," "),a(),C("was-last",h.lastAnswer()===4),a(),f(" ",(z=h.ankiCard())==null||z.nextReviews==null?null:z.nextReviews[3]," ")}}function re(n,s){if(n&1&&(c(0,"div",1)(1,"div",7)(2,"span",8)(3,"span",9),p(4),l(),c(5,"span",10),p(6),l()(),c(7,"span",11),p(8),l(),g(9,"span",12),c(10,"span",13),p(11),l(),g(12,"span",14),L(13,ne,3,2,"div",15),l(),g(14,"div",16),L(15,se,19,21),l()),n&2){let t,e,i,o,r,d=_();a(4),f(" ",d.timerCounter()," "),a(2),f(" ",d.timerTimeMin()," "),a(2),lt(" ",d.learningCardsNumber()," : ",d.cardsNumber()-d.learningCardsNumber()," : ",d.cardsNumber()," "),a(),u("innerHTML",(t=d.ankiCard())==null||t.fields==null||t.fields.term==null?null:t.fields.term.value,T),a(2),f(" (",(e=d.ankiCard())==null||e.fields==null||e.fields.pos==null?null:e.fields.pos.value,") "),a(),u("innerHTML",(i=d.ankiCard())==null||i.fields==null||i.fields.registerlab==null?null:i.fields.registerlab.value,T),a(),x(!((o=d.ankiCard())==null||o.fields==null||o.fields.phVerb==null)&&o.fields.phVerb.value||!((o=d.ankiCard())==null||o.fields==null||o.fields.lexunit==null)&&o.fields.lexunit.value?13:-1),a(),u("innerHTML",(r=d.ankiCard())==null||r.fields==null||r.fields.exampleText==null?null:r.fields.exampleText.value,T),a(),x(d.showBackSide()?15:-1)}}var jt=class n{constructor(s,t,e){this.ankiConnectService=s;this.activatedRoute=t;this.router=e}isLoading=v(!1);ankiCard=v(null);cardsNumber=v(0);learningCardsNumber=v(0);showBackSide=v(!0);lastAnswer=v(0);timerCounter=v(0);timerTimeMin=v(0);UrlsEnum=gt;ankiCardTypes=Pt;timerBaseTimeMs=Date.now();hotKeysService=m(Lt);hotKeysServiceSubscription;htmLAudioElement=null;lastCardId=0;deckName=X;ngOnInit(){this.checkDeckName(),this.getCard(),this.takeHotKey()}ngOnDestroy(){this.hotKeysServiceSubscription?.unsubscribe(),this.htmLAudioElement?.pause(),this.htmLAudioElement?.remove()}replayAudio(){this.htmLAudioElement&&(this.htmLAudioElement.currentTime=0),this.htmLAudioElement?.play()}getCard(){let s=`deck:${this.deckName} is:due`;this.isLoading.set(!0),this.showBackSide.set(!1),this.ankiConnectService.findCards(s).pipe(I(1),E(()=>{this.isLoading.set(!1)})).subscribe(t=>{this.stopAudio(),t.sort(Et),this.ankiCard.set(t[0]||null),this.cardsNumber.set(t.length),this.learningCardsNumber.set(t.filter(e=>e.type===1).length),window.scrollTo(0,0),this.initAudio()})}getCardById(s){s&&(this.isLoading.set(!0),this.showBackSide.set(!1),this.ankiConnectService.getCardById(s).pipe(I(1),E(()=>{this.isLoading.set(!1)})).subscribe(t=>{this.stopAudio(),this.ankiCard.set(t||null),this.cardsNumber.set(0),this.learningCardsNumber.set(0),window.scrollTo(0,0),this.initAudio()}))}takeHotKey(){this.hotKeysServiceSubscription=this.hotKeysService.hotKeyEvent.subscribe(s=>{switch(!0){case y("ShowExtraInfo",s):this.showBackSide.set(!0),this.replayAudio();break;case y("LearnAgain",s):this.answerCard(1);break;case y("SetHard",s):this.answerCard(2);break;case y("SetNormal",s):this.answerCard(3);break;case y("PlayAudio",s):this.replayAudio();break;case y("RestoreLastCard",s):this.restoreLastCard();break;case y("ForgetCard",s):this.forgetCard();break;case y("GoHome",s):this.goHome();break}})}forgetCard(){if(!this.showBackSide())return;this.isLoading.set(!0);let s=this.ankiCard()?.cardId;s&&this.ankiConnectService.forgetCard(s).pipe(I(1),E(()=>{this.isLoading.set(!1)})).subscribe(()=>{this.lastAnswer.set(0),this.increaseTimer(),this.getCard()})}answerCard(s){if(!this.showBackSide())return;this.isLoading.set(!0);let t=this.ankiCard()?.cardId;t&&this.ankiConnectService.answerCardsByIds([t],s).pipe(I(1),E(()=>{this.isLoading.set(!1)})).subscribe(()=>{this.lastCardId=t,this.increaseTimer(),this.lastAnswer.set(s),this.getCard()})}initAudio(){let s=this.ankiCard()?.fields?.sound?.value;if(this.htmLAudioElement=null,!s)return;let t=It(s),e=localStorage.getItem(kt.key);!t||!e||(this.htmLAudioElement=new Audio(e+t),this.htmLAudioElement.play())}stopAudio(){this.htmLAudioElement?.pause()}increaseTimer(){this.timerCounter.update(e=>e+1);let s=Math.round((Date.now()-this.timerBaseTimeMs)/1e3),t=Math.floor(s/60);this.timerTimeMin.set(t)}restoreLastCard(){this.lastCardId&&this.ankiConnectService.answerCardsByIds([this.lastCardId],1).pipe(I(1),E(()=>{this.isLoading.set(!1)})).subscribe(()=>{this.getCardById(this.lastCardId)})}checkDeckName(){let s=this.activatedRoute.snapshot.queryParams.deck,t=localStorage.getItem(At.key)?.split(" ")?.[0],e=s||t||X;s||this.router.navigate([],{relativeTo:this.activatedRoute,queryParamsHandling:"merge",queryParams:{deck:e}}),this.deckName=e}goHome(){this.router.navigate(["/"])}EasyFactorEnum=Ot;static \u0275fac=function(t){return new(t||n)(S(Ht),S(ut),S(_t))};static \u0275cmp=D({type:n,selectors:[["app-learn"]],decls:14,vars:4,consts:[[1,"empty-block"],[1,"card"],[1,"bottom"],[1,"bottom-line"],["routerLink","/"],[3,"routerLink"],[1,"hints"],[1,"term-block"],[1,"timer-block"],[1,"timer-counter"],[1,"timer-value"],[1,"cards-number"],[1,"term",3,"innerHTML"],[1,"pos"],[1,"register-lab",3,"innerHTML"],[1,"lex-unit"],[1,"example",3,"innerHTML"],[1,"ph-verb"],[1,"lex-unit",3,"innerHTML"],[1,"term-extra"],[1,"transcription",3,"innerHTML"],[1,"freq"],[1,"definition",3,"innerHTML"],[1,"translation",3,"innerHTML"],[1,"next-reviews"],["matTooltip","Again",1,"next-button",3,"click"],["matTooltip","Hard",1,"next-button",3,"click"],["matTooltip","Normal",1,"next-button","normal",3,"click"],["matTooltip","Easy",1,"next-button",3,"click"]],template:function(t,e){if(t&1&&(L(0,te,5,1,"div",0)(1,re,16,11,"div",1),c(2,"div",2)(3,"div",3)(4,"a",4),p(5," Home "),l(),c(6,"a",5),p(7," Viewer "),l(),c(8,"span",6),p(9," Space - show extra, 1-again, 2-hard, 3 (or enter) -normal. "),g(10,"br"),c(11,"span"),p(12),l(),p(13," | R - replay sound. z - restore. ForgetCard - 0. "),l()()()),t&2){let i;x(e.ankiCard()?-1:0),a(),x(e.ankiCard()?1:-1),a(5),u("routerLink","/"+e.UrlsEnum.Viewer),a(6),f(" Deck: ",(i=e.ankiCard())==null?null:i.deckName," ")}},dependencies:[ft,Mt,Z,$],styles:["[_nghost-%COMP%]{box-sizing:border-box;display:flex;flex-direction:column;height:100%;margin:0 auto;max-width:1200px;padding:24px}.bottom[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;gap:8px}.bottom[_ngcontent-%COMP%]   .bottom-line[_ngcontent-%COMP%]{display:flex;gap:8px}.card[_ngcontent-%COMP%]{align-items:center;display:flex;flex:1;flex-direction:column;gap:16px;justify-content:flex-start}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]{align-items:baseline;display:flex;font-size:24px;gap:16px}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .card-type[_ngcontent-%COMP%]{font-size:14px}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .card-type.review[_ngcontent-%COMP%]{color:green}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]{color:#00f}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .pos[_ngcontent-%COMP%]{color:green}.card[_ngcontent-%COMP%]   .transcription[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .freq[_ngcontent-%COMP%]{color:#00f;font-size:24px}.card[_ngcontent-%COMP%]   .freq[_ngcontent-%COMP%]{color:#8b0000}.card[_ngcontent-%COMP%]   .example[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .definition[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .translation[_ngcontent-%COMP%]{font-size:24px}.card[_ngcontent-%COMP%]   .translation[_ngcontent-%COMP%]{color:green}.next-reviews[_ngcontent-%COMP%]{border:1px solid gray;display:flex;font-size:24px;gap:16px;padding:4px 8px}.next-reviews.review[_ngcontent-%COMP%]{border:1px solid darkred;outline:1px solid darkred}.next-reviews[_ngcontent-%COMP%]   .normal[_ngcontent-%COMP%]{color:green}.next-reviews[_ngcontent-%COMP%]   .was-last[_ngcontent-%COMP%]{text-decoration:underline}.next-reviews[_ngcontent-%COMP%]   .next-button[_ngcontent-%COMP%]{cursor:pointer}.ph-verb[_ngcontent-%COMP%]{color:#00008b}.lex-unit[_ngcontent-%COMP%]{color:#8b0000}.cards-number[_ngcontent-%COMP%], .timer-counter[_ngcontent-%COMP%]{color:#8b008b}.timer-block[_ngcontent-%COMP%]   .timer-value[_ngcontent-%COMP%]{color:green}"]})};export{jt as LearnComponent};
