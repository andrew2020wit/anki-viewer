import{a as q}from"./chunk-BUG2RXMT.js";import{c as R,d as A,e as N}from"./chunk-CV7V65U2.js";import"./chunk-SW2ZE6OU.js";import{Ca as r,Da as o,Ea as m,I as T,Ia as v,Sa as d,Ta as h,Ua as f,Y as g,ab as E,bb as H,da as _,ea as l,ia as P,ma as w,pa as I,ra as k,s as L,u as O,va as C,wb as z,ya as x}from"./chunk-U47C5U2E.js";var S=class t{transform(i){if(!i)return"";let e=i.lastIndexOf("$");if(e===-1)return i;let n=i.slice(e+1),a=i.slice(0,e);return n.trim()===a.trim()?n:i}static \u0275fac=function(e){return new(e||t)};static \u0275pipe=I({name:"transcription",type:t,pure:!0})};function K(t,i){if(t&1&&(r(0,"span",13),d(1),o()),t&2){let e,n=v(3);l(),f(" ",(e=n.ankiCard())==null||e.fields==null||e.fields.phVerb==null?null:e.fields.phVerb.value," ")}}function V(t,i){if(t&1&&m(0,"span",14),t&2){let e,n=v(3);C("innerHTML",(e=n.ankiCard())==null||e.fields==null||e.fields.lexunit==null?null:e.fields.lexunit.value,_)}}function j(t,i){if(t&1&&(r(0,"div",11),k(1,K,2,1,"span",13)(2,V,1,1,"span",14),o()),t&2){let e,n,a=v(2);l(),x(!((e=a.ankiCard())==null||e.fields==null||e.fields.phVerb==null)&&e.fields.phVerb.value?1:-1),l(),x(!((n=a.ankiCard())==null||n.fields==null||n.fields.lexunit==null)&&n.fields.lexunit.value?2:-1)}}function F(t,i){if(t&1&&m(0,"div",19),t&2){let e,n=v(3);C("innerHTML",(e=n.ankiCard())==null||e.fields==null||e.fields.translation==null?null:e.fields.translation.value,_)}}function U(t,i){if(t&1&&(r(0,"div",15),m(1,"span",16),E(2,"transcription"),r(3,"span",17)(4,"span"),d(5),o(),r(6,"span"),d(7),o()()(),m(8,"div",18),k(9,F,1,1,"div",19),r(10,"div",20)(11,"span"),d(12),o(),r(13,"span"),d(14),o(),r(15,"span",21),d(16),o(),r(17,"span"),d(18),o()()),t&2){let e,n,a,s,c,p,M,b,y,u=v(2);l(),C("innerHTML",H(2,9,(e=u.ankiCard())==null||e.fields==null||e.fields.transcription==null?null:e.fields.transcription.value),_),l(4),f(" ",(n=u.ankiCard())==null||n.fields==null||n.fields.freq==null?null:n.fields.freq.value," "),l(2),f(" ",(a=u.ankiCard())==null||a.fields==null||a.fields.freq2==null?null:a.fields.freq2.value," "),l(),C("innerHTML",(s=u.ankiCard())==null||s.fields==null||s.fields.def==null?null:s.fields.def.value,_),l(),x(!((c=u.ankiCard())==null||c.fields==null||c.fields.translation==null)&&c.fields.translation.value?9:-1),l(3),h((p=u.ankiCard())==null||p.nextReviews==null?null:p.nextReviews[0]),l(2),h((M=u.ankiCard())==null||M.nextReviews==null?null:M.nextReviews[1]),l(2),h((b=u.ankiCard())==null||b.nextReviews==null?null:b.nextReviews[2]),l(2),h((y=u.ankiCard())==null||y.nextReviews==null?null:y.nextReviews[3])}}function X(t,i){if(t&1&&(r(0,"div",0)(1,"div",7),m(2,"span",8),r(3,"span",9),d(4),o(),m(5,"span",10),k(6,j,3,2,"div",11),o(),m(7,"div",12),k(8,U,19,11),o()),t&2){let e,n,a,s,c,p=v();l(2),C("innerHTML",(e=p.ankiCard())==null||e.fields==null||e.fields.term==null?null:e.fields.term.value,_),l(2),f(" (",(n=p.ankiCard())==null||n.fields==null||n.fields.pos==null?null:n.fields.pos.value,") "),l(),C("innerHTML",(a=p.ankiCard())==null||a.fields==null||a.fields.registerlab==null?null:a.fields.registerlab.value,_),l(),x(!((s=p.ankiCard())==null||s.fields==null||s.fields.phVerb==null)&&s.fields.phVerb.value||!((s=p.ankiCard())==null||s.fields==null||s.fields.lexunit==null)&&s.fields.lexunit.value?6:-1),l(),C("innerHTML",(c=p.ankiCard())==null||c.fields==null||c.fields.exampleText==null?null:c.fields.exampleText.value,_),l(),x(p.showBackSide()?8:-1)}}function $(t,i){t&1&&m(0,"div",1)}var B=class t{constructor(i,e){this.ankiConnectService=i;this.info=e}isLoading=g(!1);ankiCard=g(null);cardsNumber=g(0);showBackSide=g(!0);lastAnswer=g(0);ankiCardTypes=R;hotKeysService=T(q);hotKeysServiceSubscription;ngOnInit(){this.getCard(),this.takeHotKey()}ngOnDestroy(){this.hotKeysServiceSubscription?.unsubscribe()}getCard(){let i="deck:cald is:due";this.isLoading.set(!0),this.showBackSide.set(!1),this.ankiConnectService.findCards(i).pipe(L(1),O(()=>{this.isLoading.set(!1)})).subscribe(e=>{e.sort((n,a)=>n.due-a.due),this.ankiCard.set(e[0]||null),this.cardsNumber.set(e.length),window.scrollTo(0,0)})}takeHotKey(){this.hotKeysServiceSubscription=this.hotKeysService.hotKeyEvent.subscribe(i=>{switch(i){case" ":this.showBackSide.set(!0);break;case"1":this.answerCard(1);break;case"2":this.answerCard(2);break;case"3":this.answerCard(3);break;case"4":this.answerCard(4);break}})}answerCard(i){this.isLoading.set(!0);let e=this.ankiCard()?.cardId;e&&this.ankiConnectService.answerCardsByIds([e],i).pipe(L(1),O(()=>{this.isLoading.set(!1)})).subscribe(()=>{this.lastAnswer.set(i),this.getCard()})}static \u0275fac=function(e){return new(e||t)(P(N),P(A))};static \u0275cmp=w({type:t,selectors:[["app-learn"]],decls:15,vars:6,consts:[[1,"card"],[1,"loader"],[1,"settings"],["routerLink","/"],[1,"anki-result-sum"],[1,"card-type"],[1,"hints"],[1,"term-block"],[1,"term",3,"innerHTML"],[1,"pos"],[1,"register-lab",3,"innerHTML"],[1,"lex-unit"],[1,"example",3,"innerHTML"],[1,"ph-verb"],[1,"lex-unit",3,"innerHTML"],[1,"term-extra"],[1,"transcription",3,"innerHTML"],[1,"freq"],[1,"definition",3,"innerHTML"],[1,"translation",3,"innerHTML"],[1,"next-reviews"],[1,"normal"]],template:function(e,n){if(e&1&&(k(0,X,9,6,"div",0)(1,$,1,0,"div",1),r(2,"div",2)(3,"a",3),d(4," Home "),o(),r(5,"div",4),d(6),o(),r(7,"span",5),d(8),o(),r(9,"span"),d(10),o(),r(11,"span",6),d(12," | Space - show extra, 1-again, 2-hard, 3-normal, 4-ease. "),o(),r(13,"span"),d(14),o()()),e&2){let a,s;x(n.ankiCard()?0:-1),l(),x(n.isLoading()?1:-1),l(5),f("Results: ",n.cardsNumber(),""),l(2),f(" CT: ",n.ankiCardTypes[((a=n.ankiCard())==null?null:a.type)||0]," "),l(2),f(" D: ",(s=n.ankiCard())==null?null:s.deckName," "),l(4),f(" LA: ",n.lastAnswer()," ")}},dependencies:[z,S],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;margin:0 auto;max-width:800px;padding:24px;height:100%;box-sizing:border-box}.settings[_ngcontent-%COMP%]{align-items:center;display:flex;gap:8px;justify-content:start;margin-bottom:24px}.card[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column;align-items:center;justify-content:flex-start;gap:16px}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]{display:flex;font-size:24px;gap:16px}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]{color:#00f}.card[_ngcontent-%COMP%]   .term-block[_ngcontent-%COMP%]   .pos[_ngcontent-%COMP%]{color:green}.card[_ngcontent-%COMP%]   .transcription[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .freq[_ngcontent-%COMP%]{font-size:24px;color:#00f}.card[_ngcontent-%COMP%]   .freq[_ngcontent-%COMP%]{color:#8b0000}.card[_ngcontent-%COMP%]   .example[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .definition[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .translation[_ngcontent-%COMP%]{font-size:24px}.card[_ngcontent-%COMP%]   .translation[_ngcontent-%COMP%]{color:green}.next-reviews[_ngcontent-%COMP%]{display:flex;gap:16px;font-size:24px;padding:4px 8px;border:1px solid gray}.next-reviews[_ngcontent-%COMP%]   .normal[_ngcontent-%COMP%]{color:green}"]})};export{B as LearnComponent};
